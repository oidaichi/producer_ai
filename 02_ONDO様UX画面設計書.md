# 02_ONDO様UX画面設計書

参照元: `ONDO/ONDO様システム要件定義書.md`
作成日: 2025-08-13
対象: Webアプリ（日本語UI、PC最適化／スマホ閲覧・簡易編集対応）

---

## 1. 目的とスコープ
- __目的__: イベント運用資料の生成・編集・出力を、自然言語入力を中心に効率化するUXを定義する。
- __対象__: 松/竹/梅の3プランで段階的に機能提供。
  - 松: 自然言語の入力画面 → スプレッドシート形式で出力
  - 竹: 自然言語の入力画面 → Asana プロジェクトへ出力（WBS/進捗管理）
  - 梅: Asana 内でのワークフロー自動作成・追加機能
- __非機能__: PC最適化、レスポンシブ、テンプレート登録、ドキュメント編集、外部サービス連携、プロジェクト単位保存（要件定義書 2章参照）。

## 2. 情報設計（IA）
- __グローバル__: ダッシュボード／プロジェクト／生成結果／テンプレート／設定
- __プロジェクト__: 概要／入力（自然言語）／生成結果／出力設定（Spreadsheet/Asana）／履歴
- __テンプレート__: スプレッドシートテンプレート管理、プロンプトプリセット
- __設定__: 連携（Google/Asana）、権限、通知、言語・地域（日本固定）

## 3. 画面一覧
- __G1 ダッシュボード__: プロジェクト一覧、最近の生成結果、テンプレートショートカット
- __P1 プロジェクト概要__: 基本情報、連携状況、出力先既定値
- __P2 入力（自然言語）__: プロンプト入力、補助フォーム、テンプレート選択、バージョン管理
- __P3 生成結果__: タブビュー（要件、WBS、チェックリスト等）、編集・再生成
- __P4 出力設定__: スプレッドシート or Asana マッピング、プレビュー、出力実行
- __P5 履歴__: 生成履歴、差分、復元
- __T1 テンプレート__: 新規登録、編集、適用
- __S1 設定__: 連携、通知、権限、監査ログ

## 4. 共通UI/UX方針
- __タブ型レイアウト__: 複数シート（要件、体制、WBS、会場、登壇者、クリエイティブ等）を一元管理
- __右パネル__: コンテキスト支援（プロンプト例、変数プレビュー、関連ドキュメント）
- __インライン編集__: 生成結果は画面内で編集可能（要件定義 2.1.2 編集機能）
- __バージョン__: 生成・編集ごとに差分保存、ロールバック
- __アクセシビリティ__: キーボード操作、見出し構造、コントラスト配慮

## 5. フロー（上位）
- __松__: 入力 → 生成 → 編集 → スプレッドシート出力 → 共有
- __竹__: 入力 → 生成/編集 → Asana出力（プロジェクト/セクション/タスク）→ 進捗管理
- __梅__: Asana内自動化（WBS→スケジュール、依存関係、通知、チェックリスト展開 など）

## 6. 画面詳細仕様

### 6.1 P2 入力（自然言語）
- __要素__
  - 入力テキストエリア（2,000〜8,000文字想定、残字数表示）
  - プロンプトテンプレート選択（ドロップダウン＋プレビューモーダル）
  - 変数フィールド（イベント名、日付、会場、想定規模、ステークホルダー等）
  - 参考資料添付（URL、ファイルメタデータ）
  - 生成オプション（粒度: ラフ/詳細、トーン: フォーマル/カジュアル、出力先: Spreadsheet/Asana）
  - 実行ボタン、下書き保存、履歴一覧
- __バリデーション__
  - 必須: イベント名、開催日（未定可）、出力先
  - 文字数: 8,000文字上限（警告）
  - 連携状況: Asana/Google 未接続時は接続導線を表示
- __支援機能__
  - プロンプト例と構成ガイド（WBS/チェックリスト/登壇者/会場情報）
  - 自動補完（テンプレート変数）

### 6.2 P3 生成結果
- __タブ__: 概要、WBS、スケジュール案、タスクリスト、登壇者、会場、デザイン要素、リスク/課題
- __操作__: インライン編集、セクション追加、AI再生成（部分/全体）、比較ビュー
- __プレビュー__: Spreadsheetレイアウト、Asanaタスクプレビュー

### 6.3 P4 出力設定（松/竹で分岐）
- 共通: 出力先選択、テンプレート選択、フィールドマッピング、テスト出力

#### 6.3.1 松（Spreadsheet出力）
- __テンプレート__: 既存Googleスプレッドシートレイアウトに準拠（要件定義 2.1.2）
- __マッピング__: 生成タブ → シート名、列見出し → カラム、改行→セル分割の規則
- __オプション__: 既存シート追記/新規作成、保護範囲、共有権限
- __出力先__: 
  - Excel(.xlsx)ダウンロード
  - Googleスプレッドシート作成（Google Drive連携）
- __プレビュー__: 1シート単位で差分プレビュー

#### 6.3.2 竹（Asana出力）
- __プロジェクト生成__: ワークスペース/チーム選択、プロジェクト名規約 `{イベント名}_{YYYYMMDD}`
- __セクション__: 例）企画/集客/制作/当日運営/振り返り
- __タスク__: タイトル、説明、担当、期限、優先度、タグ、サブタスク
- __カスタムフィールド__: 種別（ToDo/Deliverable）、難易度、見積工数(h)、コスト、リスク
- __依存関係__: WBS順序から自動推定、クリティカルパス初期推定
- __権限__: 共有リンク、外部パートナー招待ガイド
- __Asana AI 前提__: 初回WBS投入後、Asana側でスケジュール自動引き（説明文に前提を記載）

### 6.4 梅（Asana内自動化）
- __自動ルール案__
  - ステータス移行: サブタスク全完了→親タスクを「完了直前」に移行
  - 期日調整: 依存先遅延→従属タスク期日自動シフト
  - 通知: 24h前未更新→担当者にメンション
  - チェックリスト展開: テンプレートタグ付タスク作成時にサブタスク雛形展開
- __追加機能案__
  - テンプレート管理（プロジェクト/セクション/タスク/カスタムフィールドのプリセット群）
  - クロスプロジェクト集計（進捗、燃尽、リスク）

## 7. データマッピング仕様

### 7.1 Spreadsheet マッピング例
- __シート__: `WBS`
  - 列: `WBS ID` / `タスク名` / `担当` / `開始日` / `終了日` / `所要時間(h)` / `依存関係` / `備考`
- __シート__: `登壇者`
  - 列: `氏名` / `所属` / `役割` / `連絡先` / `想定到着` / `備考`
- __シート__: `会場チェックリスト`
  - 列: `項目` / `必須` / `担当` / `期限` / `状態` / `メモ`

### 7.2 Asana フィールドマッピング例（JSONイメージ）
```json
{
  "project": {
    "name": "{イベント名}_{YYYYMMDD}",
    "team": "Marketing"
  },
  "sections": ["企画", "集客", "制作", "当日運営", "振り返り"],
  "custom_fields": {
    "種別": ["ToDo", "Deliverable"],
    "難易度": ["S", "A", "B", "C"],
    "見積工数(h)": "number",
    "コスト": "currency",
    "リスク": ["高", "中", "低"]
  },
  "task": {
    "name": "{WBS行.タスク名}",
    "notes": "{説明/チェックリスト}",
    "assignee": "{担当}",
    "due_on": "{終了日}",
    "tags": ["{タグ}"],
    "subtasks": ["{手順1}", "{手順2}"]
  }
}
```

## 8. 連携・権限・通知
- __Google__: Drive/Sheets 連携、共有リンク（閲覧/編集）、範囲保護
- __Asana__: OAuth接続、ワークスペース選択、外部共有、ゲスト権限
- __通知__: 出力完了、エラー、権限不足、連携期限切れ

## 9. エラーハンドリング
- 入力不足（必須変数未入力）
- 連携未設定（OAuth切れ）
- マッピング不一致（必須列欠落）
- 出力失敗（再試行、ログID提示）

## 10. 非機能・編集体験
- __編集__: 画面内で直接編集し保存、テンプレ適用で一括再生成
- __履歴__: 生成/編集の差分、復元、コメント
- __レスポンシブ__: PC最適、スマホは閲覧と軽微編集
- __パフォーマンス__: 生成ジョブは非同期、完了通知

## 11. セキュリティ・ガバナンス
- __認証__: SSO/OAuth
- __権限__: プロジェクト単位の閲覧/編集/出力
- __監査__: 出力ログ、API呼び出しログ
- __データ保持__: プロジェクト毎に保存、削除・エクスポート対応

## 12. テンプレートとプリセット
- スプレッドシートテンプレート登録（列/書式/保護）
- プロンプトテンプレート（松/竹/梅別）
- Asana プロジェクト雛形（セクション/カスタムフィールド）

## 13. 文言例（プロンプトガイド）
- 目的: 「{イベント名} の運営に必要なWBSとチェックリストを作成して」
- 制約: 「日程は {YYYY/MM/DD}、会場は {会場名}、参加者は約 {人数} 人」
- 出力: 「スプレッドシートにWBS、登壇者、会場チェックリストの3シートを作成」
- 竹: 「Asanaでプロジェクト作成、セクションは企画/集客/制作/当日運営/振り返り」

## 14. 成功指標（UX）
- 入力から初回出力までの時間
- 手動編集セル数の削減率
- Asanaタスクの初期充足率（担当/期限/依存）
- 再生成回数と満足度

